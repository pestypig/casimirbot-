WarpRenderInspector.tsx — use pipeline mass (kg) and remove arb proxies
--- a/src/components/WarpRenderInspector.tsx
+++ b/src/components/WarpRenderInspector.tsx
@@
-import { normalizeWU, buildREAL, buildSHOW } from "@/lib/warp-uniforms";
+import { normalizeWU, buildREAL, buildSHOW } from "@/lib/warp-uniforms";
@@
-function fmtArb(x:number){
-  if (!Number.isFinite(x)) return '— arb';
-  const abs = Math.abs(x);
-  if (abs < 1e-3) return `${(x*1e6).toFixed(2)} µarb`;
-  if (abs < 1)    return `${(x*1e3).toFixed(2)} marb`;
-  if (abs < 1e3)  return `${x.toFixed(2)} arb`;
-  if (abs < 1e6)  return `${(x/1e3).toFixed(2)} karb`;
-  return `${x.toExponential(2)} arb`;
-}
-
-// Exotic mass proxy: M* ~ θ^2 · V_shell · viewFraction   (arb units; display-only)
-function massProxy(theta:number, shellVol_m3:number, viewFraction:number){
-  const th = Math.max(0, theta||0);
-  return th*th * Math.max(0, shellVol_m3||0) * Math.max(0, viewFraction||0);
-}
+// (Removed) arbitrary-unit helpers and mass proxy; we now display pipeline kg.
@@
-function PaneOverlay(props:{
+function PaneOverlay(props:{
   title: string;
   flavor: 'REAL'|'SHOW';
   engineRef: React.MutableRefObject<any>;
-  viewFraction: number; // REAL uses 1/sectorCount, SHOW uses 1.0
+  viewFraction: number; // fraction of ship total mass visually represented in this pane
+  shipMassKg?: number;  // ship-wide exotic mass from pipeline (kg)
 }){
-  const { engineRef, flavor, viewFraction, title } = props;
+  const { engineRef, flavor, viewFraction, title, shipMassKg } = props;
   const [snap, setSnap] = useState<any>(null);
@@
       const V  = volEllipsoid(a,b,c);
       const S  = areaEllipsoid(a,b,c);
       const Vshell = Math.max(0, w_m) * Math.max(0, S); // thin-shell approx
@@
       const thetaUniform = +U.thetaScale || NaN;          // what the shader is using
       const thetaPhys    = thetaPhysicsFromUniforms(U);    // γ_geo³·q·γ_VdB_mass·√d_eff
       // optional: keep your paper clamp, but show it as "θ_paper"
       const thetaPaper   = Math.pow(26, 3) * 1 * 38.3 * Math.sqrt(2.5e-5); // ≈ 3.366e3
-      const thetaForMass = thetaPhys;
-
-      // compute both ship-total (viewFraction=1) and the visible slice
-      const M_ship_arb  = massProxy(thetaForMass, Vshell, 1.0);
-      const M_slice_arb = M_ship_arb * (flavor === 'REAL' ? viewFraction : 1.0);
-
-      // calibration priority: REAL-only → global → auto-from target ship mass
-      const Kreal   = Number((window as any).__EXOTIC_MASS_CALIB_KG_PER_ARB_REAL) || 0;
-      const Kglobal = Number((window as any).__EXOTIC_MASS_CALIB_KG_PER_ARB) || 0;
-      const target  = Number((window as any).__EXOTIC_MASS_TARGET_KG) || 0;
-      const Kauto   = (target > 0 && isFinite(M_ship_arb) && M_ship_arb > 0) ? target / M_ship_arb : 0;
-      const K_used  = (props.flavor === 'REAL') ? (Kreal || Kglobal || Kauto) : 0;
-
-      // Pane-specific display:
-      // - REAL: show kilograms (slice and ship total) if calibrated; else fallback to arb
-      // - SHOW: always arb
-      const mDisplayText = (flavor === 'REAL' && K_used > 0)
-        ? `${fmtSI(M_slice_arb * K_used, 'kg')} (slice) · ${fmtSI(M_ship_arb * K_used, 'kg')} total`
-        : fmtArb(M_slice_arb);
+      // Use pipeline exotic mass directly (kg). Slice mass = ship mass × viewFraction.
+      const M_ship_kg  = Number.isFinite(shipMassKg as number) ? Number(shipMassKg) : NaN;
+      const M_slice_kg = Number.isFinite(M_ship_kg) ? M_ship_kg * (flavor === 'REAL' ? viewFraction : 1.0) : NaN;
 
       // pull contraction/expansion from diagnostics if available
       const diag = (e?.computeDiagnostics?.() || {}) as any;
@@
       setSnap({
         a,b,c,aH, w_m, V,S, Vshell,
         thetaUniform, thetaPhys, thetaPaper,
-        M_ship_arb, M_slice_arb, K_used,
+        M_ship_kg, M_slice_kg,
         frontMax, rearMin,
         sectors: Math.max(1,(U.sectorCount|0)||1),
-        mDisplayText
+        mDisplayText: (flavor === 'REAL')
+          ? `${Number.isFinite(M_slice_kg)? fmtSI(M_slice_kg,'kg'):'— kg'} (slice) · ${Number.isFinite(M_ship_kg)? fmtSI(M_ship_kg,'kg'):'— kg'} total`
+          : `${Number.isFinite(M_ship_kg)? fmtSI(M_ship_kg,'kg'):'— kg'} total`
       });
       raf = requestAnimationFrame(tick);
     };
@@
         <div className="mt-1 grid grid-cols-2 gap-x-4 gap-y-1 text-[11px] text-white/85">
           <div>θ (uniform): <b>{Number.isFinite(s.thetaUniform)? s.thetaUniform.toExponential(2):'—'}</b></div>
           <div>θ (phys): <b>{Number.isFinite(s.thetaPhys)? s.thetaPhys.toExponential(2):'—'}</b></div>
           <div className="text-white/60">θ (paper): <b>{Number.isFinite(s.thetaPaper)? s.thetaPaper.toExponential(2):'—'}</b></div>
-          <div>θ (metric): <b>{Number.isFinite(s.u_epsilonTilt)? s.u_epsilonTilt.toExponential(2):'—'}</b></div>
+          {/* keep slot if you later expose a metric-curvature scalar */}
+          <div>θ (metric): <b>—</b></div>
           <div>view fraction: <b>{(flavor==='REAL'? props.viewFraction : 1).toFixed(4)}</b></div>
           <div>shell volume: <b>{fmtSI(s.Vshell,'m³')}</b></div>
-          {/* REAL shows kg when calibrated; SHOW remains arb */}
+          {/* Show kilograms sourced from pipeline */}
           <div>
-            exotic mass{(flavor==='REAL' && s.K_used>0) ? '' : '*'} :
-            {' '}<b>{s.mDisplayText}</b>
+            exotic mass: <b>{s.mDisplayText}</b>
           </div>
           <div>front(+): <b>{Number.isFinite(s.frontMax)? s.frontMax.toExponential(2):'—'}</b></div>
           <div>rear(−): <b>{Number.isFinite(s.rearMin)? s.rearMin.toExponential(2):'—'}</b></div>
         </div>
@@
             <div>
               <div className="opacity-80">Exotic mass proxy (display-only</div>
               <div className="space-y-1">
-                <div>
-                  <code>M* = θ² · V_shell · 1</code> (ship total, arb) → <b>{fmtArb(s.M_ship_arb)}</b>
-                </div>
-                <div>
-                  <code>M*slice = M* · viewFraction</code> →{' '}
-                  { (flavor==='REAL' && s.K_used>0)
-                    ? <b>{fmtSI(s.M_slice_arb*s.K_used,'kg')} (slice) · {fmtSI(s.M_ship_arb*s.K_used,'kg')} total</b>
-                    : <b>{fmtArb(s.M_slice_arb)}</b>
-                  }
-                </div>
-                {!(flavor==='REAL' && s.K_used>0) && (
-                  <div className="text-white/60">
-                    * arb = arbitrary units. Set <code>window.__EXOTIC_MASS_CALIB_KG_PER_ARB</code> or
-                    {' '}<code>window.__EXOTIC_MASS_TARGET_KG</code> to see kg on REAL.
-                  </div>
-                )}
+                <div>
+                  <code>M<sub>ship</sub> (kg)</code> → <b>{Number.isFinite(s.M_ship_kg)? fmtSI(s.M_ship_kg,'kg'):'— kg'}</b>
+                </div>
+                <div>
+                  <code>M<sub>slice</sub> = M<sub>ship</sub> · viewFraction</code> →{' '}
+                  <b>{Number.isFinite(s.M_slice_kg)? fmtSI(s.M_slice_kg,'kg'):'— kg'}</b>
+                </div>
               </div>
             </div>
           </div>
         </details>
       </div>
@@
   const wallWidth_m      = N(props.baseShared?.wallWidth_m ?? live?.hull?.wallThickness_m, 1.0);
   // let callers optionally provide a thinner analytical slice (else assume full wall)
   const sliceThickness_m = N(props.baseShared?.sliceThickness_m, wallWidth_m);
@@
   const viewMassFracREAL = sectorFrac * bandCover;
@@
           <div className="rounded-xl overflow-hidden bg-black/90 flex flex-col"
                style={{ aspectRatio: '16 / 10', minHeight: 420 }}>
             <div className="relative flex-1">
@@
               ) : (
                 <canvas
                   ref={leftRef}
                   className="absolute inset-0 w-full h-full block touch-manipulation select-none"
                   style={{ background: '#000' }}
                 />
               )}
-              {!IS_COARSE && <PaneOverlay title="REAL · per-pane slice" flavor="REAL" engineRef={leftEngine} viewFraction={viewMassFracREAL}/>}
+              {!IS_COARSE && (
+                <PaneOverlay
+                  title="REAL · per-pane slice"
+                  flavor="REAL"
+                  engineRef={leftEngine}
+                  viewFraction={viewMassFracREAL}
+                  shipMassKg={live?.M_exotic}
+                />
+              )}
             </div>
           </div>
         </article>
@@
               ) : (
                 <canvas ref={rightRef} className="absolute inset-0 w-full h-full block touch-manipulation select-none"/>
               )}
-              {!IS_COARSE && <PaneOverlay title="SHOW · cosmetic ampl" flavor="SHOW" engineRef={rightEngine} viewFraction={1.0}/>}
+              {!IS_COARSE && (
+                <PaneOverlay
+                  title="SHOW · cosmetic ampl"
+                  flavor="SHOW"
+                  engineRef={rightEngine}
+                  viewFraction={1.0}
+                  shipMassKg={live?.M_exotic}
+                />
+              )}
             </div>
           </div>
         </article>
       </section>