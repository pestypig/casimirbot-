2) Guard the formatter where the number is rendered

Right now you do:

{(activeTiles.avgTiles ?? 2_800_000).toLocaleString()}


?? does not catch NaN (it only catches null/undefined), so you still print “NaN”. Replace the panel’s render with:

- <p className="text-lg font-mono text-cyan-400">
-   {(activeTiles.avgTiles ?? 2_800_000).toLocaleString()}
-   <Tooltip> … FR-avg … </Tooltip>
- </p>
+ <p className="text-lg font-mono text-cyan-400">
+   {Number.isFinite(activeTiles?.avgTiles)
+     ? Math.round(activeTiles!.avgTiles!).toLocaleString()
+     : '2,800,000'}
+   <Tooltip> … FR-avg … </Tooltip>
+ </p>

- <p className="text-sm font-mono text-emerald-400 mt-1">
-   {Number.isFinite(activeTiles.instantTilesSmooth)
-     ? activeTiles.instantTilesSmooth.toLocaleString()
-     : '—'}
-   <span className="ml-2 text-xs text-slate-400">instant</span>
- </p>
+ <p className="text-sm font-mono text-emerald-400 mt-1">
+   {Number.isFinite(activeTiles?.instantTilesSmooth)
+     ? Math.round(activeTiles!.instantTilesSmooth!).toLocaleString()
+     : '—'}
+   <span className="ml-2 text-xs text-slate-400">instant</span>
+ </p>


This alone stops “NaN” from showing even if a future refactor reintroduces a bad value.

(Nice-to-have) Harden useActiveTiles itself

If you control that hook, add clamps inside:

// inside useActiveTiles
const T  = Math.max(0, Number(totalTiles) || 0);
const fr = Math.max(0, Math.min(1, Number(dutyEffectiveFR_safe) || 0));
const S  = Math.max(1, Number(totalSectors) || 1);
const live = Math.max(1, Number(concurrentSectors) || 1);

const burstLocal = Number.isFinite(lc?.burst_ms) && Number.isFinite(lc?.dwell_ms) && lc!.dwell_ms! > 0
  ? Math.max(0, Math.min(1, lc!.burst_ms! / lc!.dwell_ms!))
  : 0.01;

const avgTiles = T * fr;                                    // FR-averaged
const instBase = tilesPerSector ?? Math.floor(T / S);       // current sector window
const instantTiles = instBase * live * burstLocal;

return {
  avgTiles: Number.isFinite(avgTiles) ? avgTiles : 0,
  instantTilesSmooth: Number.isFinite(instantTiles) ? instantTiles : 0,
  burstLocal,
};