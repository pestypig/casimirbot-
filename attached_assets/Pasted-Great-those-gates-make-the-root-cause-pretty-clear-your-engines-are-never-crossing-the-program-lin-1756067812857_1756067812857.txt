Great—those gates make the root cause pretty clear: your engines are never crossing the “program linked” boundary, so all pushes are getting queued and the renderer keeps reporting “no program”.

You already have _setLoaded, onceReady, and the guards. What’s missing is the moment where you actually flip the engine to “ready” after a successful link and cache locations. Below are drop-in patches that close that gap and fix the exact checkpoints you’re seeing.

1) Link → cache → mark ready (both async & sync paths)

Add a tiny helper that runs when linking succeeds:

// client/public/warp-engine.js
_onProgramLinked(program) {
  const gl = this.gl;
  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
    console.error('Shader program link error:', gl.getProgramInfoLog(program));
    gl.deleteProgram(program);
    return false;
  }
  // cache locations & mark ready
  this._cacheGridLocations(program);
  this._warnNoProgramOnce = false;
  this._setLoaded(true);
  return true;
}

_cacheGridLocations(program) {
  const gl = this.gl;
  this.gridProgram = program;
  this.gridAttribs = {
    position: gl.getAttribLocation(program, 'a_position'),
  };
  this.gridUniforms = {
    mvpMatrix:  gl.getUniformLocation(program, 'u_mvpMatrix'),
    sheetColor: gl.getUniformLocation(program, 'u_sheetColor'),
    thetaScale: gl.getUniformLocation(program, 'u_thetaScale'),
    ridgeMode:  gl.getUniformLocation(program, 'u_RidgeMode'),
    parity:     gl.getUniformLocation(program, 'u_PhysicsParityMode'),
    sectorCount:gl.getUniformLocation(program, 'u_SectorCount'),
    split:      gl.getUniformLocation(program, 'u_Split'),
  };
}


Now wire it into your linker (handles both KHR async and normal sync):

_linkProgram(vertexShader, fragmentShader, onReady) {
  const gl = this.gl;
  const program = gl.createProgram();
  gl.attachShader(program, vertexShader);
  gl.attachShader(program, fragmentShader);
  gl.linkProgram(program);

  // async path (KHR_parallel_shader_compile)
  if (this.parallelShaderExt && onReady) {
    this._pollShaderCompletion(program, () => {
      if (this._onProgramLinked(program)) onReady(program);
    });
    return program;
  }

  // sync path
  this._onProgramLinked(program);
  if (onReady) try { onReady(program); } catch {}
  return program;
}


If you don’t already set it, grab the extension once (e.g., in the constructor):
this.parallelShaderExt = this.gl.getExtension('KHR_parallel_shader_compile');