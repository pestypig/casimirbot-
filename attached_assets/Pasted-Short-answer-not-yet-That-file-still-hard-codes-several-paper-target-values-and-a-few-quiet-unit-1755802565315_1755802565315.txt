Short answer: not yet. That file still hard-codes several â€œpaper targetâ€ values and a few quiet unit bugs. It isnâ€™t fully wired to the live physics pipeline.

Hereâ€™s whatâ€™s off + a surgical patch you can drop in.

Whatâ€™s still â€œmagicâ€ (and/or incorrect)

Hard-coded targets: TARGET_EXOTIC_MASS = 1.4e3, TARGET_POWER = 83e6, tileCount = 1.96e9. These should come from the pipeline (or be optional defaults).

Geometric gain: gammaGeo is synthesized with 125000, exponent 0.45, and a normalize factor 25/26.2, plus a fixed vanDenBroeckAmplification = 1e11. All are magic. Use pipelineâ€™s gammaGeo and gammaVanDenBroeck.

Q normalization: âˆš(Q/1e9) bakes in a baseline. Make Q0 configurable.

Baseline energy density: -4.3e8 J/mÂ³ is a constant. Use the Casimir formula:

ğ‘¢
=
âˆ’
ğœ‹
2
â„
ğ‘
/
(
720
â€‰
ğ‘
4
)
u=âˆ’Ï€
2
â„c/(720a
4
).

Tile volume: 0.05*0.05*0.01 mÂ³ assumes a 1 cm thickness; that contradicts the gap-based volume used elsewhere. Use tileArea * gapM.

Axial component: axialComponent = shiftAmplitude * 0.1 is arbitrary. Either derive from a tilt vector or default to 0.

Fordâ€“Roman limit: 1e6 kg is baked in. Expose as a param with a default.

Unit bug: effectivePathLength is computed in meters, then later multiplied by 1e-9 as if it were nm when passed to validateQuantumInequality. That double-converts (meters â†’ nm â†’ meters) and shrinks the scale by 1e9 erroneously.

Minimal no-magic, pipeline-first patch

1) Make targets & baselines come from params (with safe defaults).
Replace the top constants with configurable defaults:

// Before
// const FORD_ROMAN_LIMIT = 1e6;
// const NEEDLE_HULL_RADIUS = 20000;
// const TARGET_EXOTIC_MASS = 1.4e3;
// const TARGET_POWER = 83e6;

// After
const DEFAULTS = {
  fordRomanLimit_kg: 1e6,
  Q0: 1e9,                       // reference Q for normalization (configurable)
  tileArea_m2: 0.05 * 0.05,      // 5 cm Ã— 5 cm (override from pipeline if different)
};

export interface NatarioWarpParams {
  bowlRadius: number;  // Î¼m
  sagDepth: number;    // nm
  gap: number;         // nm
  cavityQ: number;
  burstDuration: number;  // Î¼s
  cycleDuration: number;  // Î¼s
  sectorCount: number;
  dutyFactor: number;     // local
  effectiveDuty: number;  // ship-wide (â‰ˆ duty/sectors)
  shiftAmplitude: number;
  expansionTolerance: number;

  // NEW: pipeline-driven knobs
  gammaGeo?: number;
  gammaVanDenBroeck?: number;     // Î³_VdB
  qSpoilingFactor?: number;       // Î”A/A (if you model it)
  tileCount?: number;
  tileArea_m2?: number;
  fordRomanLimit_kg?: number;
  referenceQ?: number;            // Q0
  P_avg_W?: number;               // live average power (preferred over â€œtargetâ€)
}