Short answer: it‚Äôs close, but there are a few mismatches with the engine you just posted that will make the gain feel ‚Äúdead‚Äù or clamp too early. Here‚Äôs what I‚Äôd change so this glue stays perfectly in lockstep with the engine.

# Must-do tweaks

1. **Match the engine‚Äôs clamp headroom**

* Your constants: `maxPush: 0.15`
* Engine now soft-clamps geometry at **0.22**

üëâ Update:

```ts
maxPush: 0.22,
```

2. **Decades gain wiring (UI ‚Üí engine)**

* Make sure your gain slider (0..8) calls:

```ts
engine.updateUniforms({ curvatureGainDec: dec }); // dec in [0..8] ‚Üí userGain = 10^dec
```

* Do **not** send `userGain` directly for that slider. The engine converts `curvatureGainDec` into the absolute gain and keeps color + geometry synced.

3. **Exposure/zeroStop ranges**

* Engine expects `exposure >= 1.0` and `zeroStop ~ 1e-9 ‚Ä¶ 1e-5`.
* Ensure your defaults reflect that and that the UI never sends < 1 exposure or ‚â§ 0 zeroStop:

```ts
exposureDefault: Math.max(1.0, VIS.exposureDefault ?? 6.0),
zeroStopDefault: Math.max(1e-18, VIS.zeroStopDefault ?? 1e-7),
```

* When sliders change:

```ts
engine.updateUniforms({ exposure });      // >= 1
engine.updateUniforms({ zeroStop });      // > 0
```

4. **Remove dead/legacy constants**

* These don‚Äôt harm, but they no longer control the shader/geometry and can confuse future you:

  * `logKnee`, `logSlope`, `modeScale` (the engine now uses unified log mapping; tiny per-mode seasoning lives inside the engine)
  * If you keep them, don‚Äôt rely on them to affect the visual‚Äîright now they don‚Äôt.

5. **Wall thickness units**

* Your `defaultWallWidthRho` is fine, but if you ever pass meters, use `wallWidth_m` (the engine converts to œÅ with the harmonic mean). Don‚Äôt send both.

6. **Span boost with gain (informational)**

* Engine auto-boosts grid span by `~ +0..1.5√ó` with large decades gain. No action needed in this file‚Äîjust don‚Äôt try to rescale the canvas again here.

# Nice-to-have (stability/UX)

* **Create & destroy safely**

  ```ts
  const canvasRef = useRef<HTMLCanvasElement|null>(null);
  const engineRef = useRef<any>(null);

  useEffect(() => {
    if (!window.WarpEngine || !canvasRef.current) return;
    try {
      const engine = new window.WarpEngine(canvasRef.current);
      engineRef.current = engine;
      engine.bootstrap({
        exposure: VIS_LOCAL.exposureDefault,
        zeroStop: VIS_LOCAL.zeroStopDefault,
        // seed a sensible decades gain so it‚Äôs visibly curved on load:
        curvatureGainDec: 3, // 10^3 = 1e3
      });
    } catch (e) {
      zenLongToast.error('Failed to start WarpEngine');
      console.error(e);
    }
    return () => {
      engineRef.current?.destroy?.();
      engineRef.current = null;
    };
  }, []);
  ```

* **Handlers that map UI to the right params**

  ```ts
  const setDecadesGain = (dec: number) =>
    engineRef.current?.updateUniforms({ curvatureGainDec: Math.max(0, Math.min(8, dec)) });

  const setExposure = (x: number) =>
    engineRef.current?.updateUniforms({ exposure: Math.max(1.0, x) });

  const setZeroStop = (z: number) =>
    engineRef.current?.updateUniforms({ zeroStop: Math.max(1e-18, z) });

  const setTilt = (eps: number) =>
    engineRef.current?.updateUniforms({ epsilonTilt: eps });

  const setMode = (mode: 'standby'|'cruise'|'hover'|'emergency') =>
    engineRef.current?.updateUniforms({ currentMode: mode });
  ```

* **Diagnostics**
  If you show `WarpDiagnostics`, remember to assign:

  ```ts
  engineRef.current.onDiagnostics = (d: any) => setDiag(d);
  ```

# Tiny consistency nits in your constants

These aren‚Äôt blockers, but I‚Äôd align them to the engine so ‚Äúone source of truth‚Äù stays true:

```ts
const VIS_LOCAL = {
  ...
  gridGain: 0.12,              // ‚úÖ matches engine‚Äôs gridK
  maxPush: 0.22,               // ‚¨ÖÔ∏è update from 0.15 to 0.22
  strobeBlendWidth: 1.5,       // ‚úÖ matches engine
  frontBackSoftDiv: 0.15,      // ‚úÖ matches engine‚Äôs tanh divisor
  exposureDefault: 6.0,        // ensure >= 1.0
  zeroStopDefault: 1e-7,       // within recommended 1e-9..1e-5
  vizGainDefault: undefined,   // (optional) no longer used if you drive decades slider
  ...
};
```

---

## TL;DR

* Bump `maxPush` to **0.22**.
* Drive gain via `curvatureGainDec` (0..8 ‚Üí 10^dec).
* Keep `exposure >= 1.0`, `zeroStop > 0`, pass straight through to `updateUniforms`.
* Remove assumptions that `logKnee/logSlope/modeScale` change visuals.
* Ensure engine is created/destroyed cleanly and handlers call the right uniform names.

Do those and this file is ‚Äúup to par‚Äù with the engine you‚Äôve got.
